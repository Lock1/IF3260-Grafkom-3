<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <title>IF3260 - K04-2 - Tubes 3</title>
</head>

<body>
    <div class="row">
        <div>
            <canvas id="canvas" width="520" height="520"></canvas>
        </div>

        <div>
            <form name="model" id="model" action="">
                <h2>Bentuk</h2>
                <input type="file" id="obj-input"/>
                <input type="color" id="color_picker" value="#ff5000">
                <div>
                    <label for="bentuk">Jenis bentuk:</label>
                    <input type="radio" name="bentuk" value="cube" checked>Kubus
                    <input type="radio" name="bentuk" value="tetrahedral">Tetrahedral
                    <input type="radio" name="bentuk" value="icosahedron">Icosahedron
                </div>
                <br>

                <h2>Proyeksi</h2>
                <div>
                    <label for="proyeksi">Jenis proyeksi:</label>
                    <input type="radio" name="proyeksi" value="orthographic" checked>Orthographic
                    <input type="radio" name="proyeksi" value="oblique">Oblique
                    <input type="radio" name="proyeksi" value="perspective">Perspective
                </div>
                <br>

                <h2>Utilitas</h2>
                <div>
                    <label for="shading">Shading: </label>
                    <input type="checkbox" id="shading" name="shading" value="shading" checked>
                </div>
                <div>
                    <input type="reset" id="reset" name="reset" value="Reset">
                </div>
                <br>


            </form>
        </div>
    </div>
    <br>
</body>







<script id="vertex-shader-3d" type="x-shader/x-vertex">
    attribute vec3 coordinates;
    attribute vec3 a_normal;

    uniform mat4 transformationMatrix;
    uniform float fudgeFactor;
    uniform mat4 uProjectionMatrix;
    uniform vec3 lightCoordinate;

    varying float colorFactor;
    varying vec3 normal;
    varying vec3 surface;

    void main(void) {
        vec4 transformedPos = transformationMatrix * vec4(coordinates.xy, coordinates.z * -1.0, 1.0);
        vec4 projectedPos   = uProjectionMatrix * transformedPos;
        float zDivider      = 2.0 + projectedPos.z * fudgeFactor;
        vec4 location       = vec4(projectedPos.xy / zDivider, projectedPos.zw);
        gl_Position         = location;

        // -- Light --
        // Using normal
        normal              = (uProjectionMatrix * transformationMatrix * vec4(a_normal, 1.0)).xyz;
        // normal              = (transformationMatrix * vec4(a_normal, 1.0)).xyz;
        surface             = lightCoordinate - vec3(location);

        // Simple z-directional
        // colorFactor         = max((1.0 - transformedPos.z) / 2.0, 0.2);
    }
</script>



<script id="fragment-shader-3d-light" type="x-shader/x-fragment">
    precision mediump float;
    uniform vec3 userColor;

    // varying float colorFactor;
    varying vec3 normal;
    varying vec3 surface;

    void main(void) {
        // -- Light --
        // Using normal
        vec3 normed_norm = normalize(normal);
        float light      = dot(normed_norm, surface);
        gl_FragColor     = vec4(userColor * max(light, 0.05), 1.0);

        // Simple z-directional
        // gl_FragColor     = vec4(userColor * colorFactor, 1.0);
    }
</script>

<script id="fragment-shader-3d-flat" type="x-shader/x-fragment">
    precision mediump float;
    uniform vec3 userColor;
    varying vec3 normal;

    void main(void) {
        gl_FragColor = vec4(userColor, 1.0);
    }
</script>







<script src="scripts/model-util.js"></script>
<script src="scripts/builtin-model.js"></script>
<script src="scripts/math-util.js"></script>
<script src="scripts/gl-util.js"></script>
<script src="scripts/builtin-arti-model.js"></script>
<script src="scripts/script.js"></script>

</html>
